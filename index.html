<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VA Restless Leg Syndrome Location Finder</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 40px;
        }

        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 10px;
            font-size: 28px;
        }

        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .search-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        input[type="text"], select {
            flex: 1;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
            background: white;
        }

        input[type="text"]:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }

        select {
            cursor: pointer;
        }

        button {
            padding: 12px 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .loading {
            text-align: center;
            color: #667eea;
            font-weight: 600;
            margin: 20px 0;
        }

        .error {
            background: #fee;
            border: 2px solid #fcc;
            color: #c33;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .results {
            margin-top: 30px;
        }

        .location-card {
            background: #fff;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        .location-card:hover {
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .location-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 15px;
        }

        .location-name {
            font-size: 20px;
            font-weight: 700;
            color: #2c3e50;
            flex: 1;
        }

        .diagnosis-badge {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 18px;
            white-space: nowrap;
            margin-left: 15px;
        }

        .distance {
            color: #7f8c8d;
            font-size: 14px;
            margin-bottom: 15px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: auto 1fr;
            gap: 8px 15px;
            margin-bottom: 15px;
            font-size: 14px;
        }

        .info-label {
            font-weight: 600;
            color: #555;
        }

        .info-value {
            color: #333;
        }

        .provider-search {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 2px solid #f0f0f0;
        }

        .provider-button {
            padding: 10px 20px;
            font-size: 14px;
            background: #2ecc71;
            margin-top: 10px;
        }

        .provider-button:hover {
            background: #27ae60;
        }

        .provider-link {
            display: inline-block;
            margin-top: 10px;
            color: #667eea;
            text-decoration: none;
            font-weight: 600;
            font-size: 14px;
        }

        .provider-link:hover {
            text-decoration: underline;
        }

        .no-results {
            text-align: center;
            color: #7f8c8d;
            padding: 40px;
            font-size: 18px;
        }

        .note {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 12px;
            border-radius: 6px;
            font-size: 13px;
            margin-top: 10px;
        }

        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }

            .input-group {
                flex-direction: column;
            }

            .location-header {
                flex-direction: column;
            }

            .diagnosis-badge {
                margin-left: 0;
                margin-top: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üè• VA Restless Leg Syndrome Finder</h1>
        <p class="subtitle">Find VA locations near you with RLS diagnosis counts and Sleep Specialists</p>

        <div class="search-section">
            <div class="input-group">
                <input type="text" id="city" placeholder="Enter City (e.g., Los Angeles)">
                <select id="state">
                    <option value="">Select State</option>
                    <option value="AL">Alabama</option>
                    <option value="AK">Alaska</option>
                    <option value="AZ">Arizona</option>
                    <option value="AR">Arkansas</option>
                    <option value="CA">California</option>
                    <option value="CO">Colorado</option>
                    <option value="CT">Connecticut</option>
                    <option value="DE">Delaware</option>
                    <option value="DC">District of Columbia</option>
                    <option value="FL">Florida</option>
                    <option value="GA">Georgia</option>
                    <option value="HI">Hawaii</option>
                    <option value="ID">Idaho</option>
                    <option value="IL">Illinois</option>
                    <option value="IN">Indiana</option>
                    <option value="IA">Iowa</option>
                    <option value="KS">Kansas</option>
                    <option value="KY">Kentucky</option>
                    <option value="LA">Louisiana</option>
                    <option value="ME">Maine</option>
                    <option value="MD">Maryland</option>
                    <option value="MA">Massachusetts</option>
                    <option value="MI">Michigan</option>
                    <option value="MN">Minnesota</option>
                    <option value="MS">Mississippi</option>
                    <option value="MO">Missouri</option>
                    <option value="MT">Montana</option>
                    <option value="NE">Nebraska</option>
                    <option value="NV">Nevada</option>
                    <option value="NH">New Hampshire</option>
                    <option value="NJ">New Jersey</option>
                    <option value="NM">New Mexico</option>
                    <option value="NY">New York</option>
                    <option value="NC">North Carolina</option>
                    <option value="ND">North Dakota</option>
                    <option value="OH">Ohio</option>
                    <option value="OK">Oklahoma</option>
                    <option value="OR">Oregon</option>
                    <option value="PA">Pennsylvania</option>
                    <option value="PR">Puerto Rico</option>
                    <option value="RI">Rhode Island</option>
                    <option value="SC">South Carolina</option>
                    <option value="SD">South Dakota</option>
                    <option value="TN">Tennessee</option>
                    <option value="TX">Texas</option>
                    <option value="UT">Utah</option>
                    <option value="VT">Vermont</option>
                    <option value="VA">Virginia</option>
                    <option value="WA">Washington</option>
                    <option value="WV">West Virginia</option>
                    <option value="WI">Wisconsin</option>
                    <option value="WY">Wyoming</option>
                </select>
                <button id="searchBtn" onclick="searchLocations()">Search Locations</button>
            </div>
            <div class="note">
                <strong>Note:</strong> Diagnosis counts showing "&lt;100" indicate fewer than 100 recorded cases at that location.
            </div>
        </div>

        <div id="loading" class="loading" style="display: none;">
            üîç Searching for nearby VA locations...
        </div>

        <div id="error" class="error" style="display: none;"></div>

        <div id="results" class="results"></div>
    </div>

    <script>
        // Embedded CSV data with addresses
        const vaData = [
            { name: "Togus, ME HCS", code: "402", region: "V01", diagnoses: 608, lat: 44.3106, lon: -69.7195, address: "1 VA Center, Augusta, ME 04330" },
            { name: "White River Junction, VT HCS", code: "405", region: "V01", diagnoses: 350, lat: 43.6489, lon: -72.3195, address: "215 N Main St, White River Junction, VT 05009" },
            { name: "Bedford, MA HCS", code: "518", region: "V01", diagnoses: 141, lat: 42.4905, lon: -71.2756, address: "200 Springs Rd, Bedford, MA 01730" },
            { name: "Boston, MA HCS", code: "523", region: "V01", diagnoses: 512, lat: 42.3601, lon: -71.0589, address: "150 S Huntington Ave, Boston, MA 02130" },
            { name: "Manchester, NH HCS", code: "608", region: "V01", diagnoses: 282, lat: 42.9956, lon: -71.4548, address: "718 Smyth Rd, Manchester, NH 03104" },
            { name: "Central Western Massachusetts HCS", code: "631", region: "V01", diagnoses: 264, lat: 42.1015, lon: -72.5898, address: "421 N Main St, Leeds, MA 01053" },
            { name: "Providence, RI HCS", code: "650", region: "V01", diagnoses: 230, lat: 41.8240, lon: -71.4128, address: "830 Chalkstone Ave, Providence, RI 02908" },
            { name: "Connecticut HCS", code: "689", region: "V01", diagnoses: 411, lat: 41.5623, lon: -72.6506, address: "950 Campbell Ave, West Haven, CT 06516" },
            { name: "Bronx, NY HCS", code: "526", region: "V02", diagnoses: "<100", lat: 40.8448, lon: -73.8648, address: "130 W Kingsbridge Rd, Bronx, NY 10468" },
            { name: "Western New York HCS", code: "528", region: "V02", diagnoses: 319, lat: 42.8864, lon: -78.8784, address: "3495 Bailey Ave, Buffalo, NY 14215" },
            { name: "Finger Lakes, NY HCS", code: "528A6", region: "V02", diagnoses: 293, lat: 43.1566, lon: -77.6088, address: "400 Fort Hill Ave, Canandaigua, NY 14424" },
            { name: "Syracuse, NY HCS", code: "528A7", region: "V02", diagnoses: 376, lat: 43.0481, lon: -76.1474, address: "800 Irving Ave, Syracuse, NY 13210" },
            { name: "Albany, NY HCS", code: "528A8", region: "V02", diagnoses: 334, lat: 42.6526, lon: -73.7562, address: "113 Holland Ave, Albany, NY 12208" },
            { name: "New Jersey HCS", code: "561", region: "V02", diagnoses: 308, lat: 40.0583, lon: -74.4057, address: "385 Tremont Ave, East Orange, NJ 07018" },
            { name: "Hudson Valley, NY HCS", code: "620", region: "V02", diagnoses: 147, lat: 41.7032, lon: -73.9276, address: "2094 Albany Post Rd, Montrose, NY 10548" },
            { name: "New York Harbor HCS", code: "630", region: "V02", diagnoses: "<100", lat: 40.7128, lon: -74.0060, address: "423 E 23rd St, New York, NY 10010" },
            { name: "Northport, NY HCS", code: "632", region: "V02", diagnoses: 117, lat: 40.9009, lon: -73.3262, address: "79 Middleville Rd, Northport, NY 11768" },
            { name: "Wilmington, DE HCS", code: "460", region: "V04", diagnoses: 254, lat: 39.7391, lon: -75.5398, address: "1601 Kirkwood Hwy, Wilmington, DE 19805" },
            { name: "Altoona, PA HCS", code: "503", region: "V04", diagnoses: 413, lat: 40.5187, lon: -78.3947, address: "2907 Pleasant Valley Blvd, Altoona, PA 16602" },
            { name: "Butler, PA HCS", code: "529", region: "V04", diagnoses: 174, lat: 40.8612, lon: -79.8953, address: "325 New Castle Rd, Butler, PA 16001" },
            { name: "Coatesville, PA HCS", code: "542", region: "V04", diagnoses: 146, lat: 39.9831, lon: -75.8238, address: "1400 Blackhorse Hill Rd, Coatesville, PA 19320" },
            { name: "Erie, PA HCS", code: "562", region: "V04", diagnoses: 261, lat: 42.1292, lon: -80.0851, address: "135 E 38th St, Erie, PA 16504" },
            { name: "Lebanon, PA HCS", code: "595", region: "V04", diagnoses: 535, lat: 40.3409, lon: -76.4113, address: "1700 S Lincoln Ave, Lebanon, PA 17042" },
            { name: "Philadelphia, PA HCS", code: "642", region: "V04", diagnoses: 639, lat: 39.9526, lon: -75.1652, address: "3900 Woodland Ave, Philadelphia, PA 19104" },
            { name: "Pittsburgh, PA HCS", code: "646", region: "V04", diagnoses: 605, lat: 40.4406, lon: -79.9959, address: "University Dr C, Pittsburgh, PA 15240" },
            { name: "Wilkes-Barre, PA HCS", code: "693", region: "V04", diagnoses: 464, lat: 41.2459, lon: -75.8813, address: "1111 E End Blvd, Wilkes-Barre, PA 18711" },
            { name: "Baltimore, MD HCS", code: "512", region: "V05", diagnoses: 373, lat: 39.2904, lon: -76.6122, address: "10 N Greene St, Baltimore, MD 21201" },
            { name: "Beckley, WV HCS", code: "517", region: "V05", diagnoses: 209, lat: 37.7782, lon: -81.1882, address: "200 Veterans Ave, Beckley, WV 25801" },
            { name: "Clarksburg, WV HCS", code: "540", region: "V05", diagnoses: 400, lat: 39.2806, lon: -80.3445, address: "1 Medical Center Dr, Clarksburg, WV 26301" },
            { name: "Huntington, WV HCS", code: "581", region: "V05", diagnoses: 428, lat: 38.4192, lon: -82.4452, address: "1540 Spring Valley Dr, Huntington, WV 25704" },
            { name: "Martinsburg, WV HCS", code: "613", region: "V05", diagnoses: 440, lat: 39.4562, lon: -77.9639, address: "510 Butler Ave, Martinsburg, WV 25405" },
            { name: "Washington, DC HCS", code: "688", region: "V05", diagnoses: 247, lat: 38.9072, lon: -77.0369, address: "50 Irving St NW, Washington, DC 20422" },
            { name: "Durham, NC HCS", code: "558", region: "V06", diagnoses: 726, lat: 35.9940, lon: -78.8986, address: "508 Fulton St, Durham, NC 27705" },
            { name: "Fayetteville, NC HCS", code: "565", region: "V06", diagnoses: 796, lat: 35.0527, lon: -78.8784, address: "2300 Ramsey St, Fayetteville, NC 28301" },
            { name: "Hampton, VA HCS", code: "590", region: "V06", diagnoses: 532, lat: 37.0299, lon: -76.3452, address: "100 Emancipation Dr, Hampton, VA 23667" },
            { name: "Asheville, NC HCS", code: "637", region: "V06", diagnoses: 702, lat: 35.5951, lon: -82.5515, address: "1100 Tunnel Rd, Asheville, NC 28805" },
            { name: "Richmond, VA HCS", code: "652", region: "V06", diagnoses: 1250, lat: 37.5407, lon: -77.4360, address: "1201 Broad Rock Blvd, Richmond, VA 23249" },
            { name: "Salem, VA HCS", code: "658", region: "V06", diagnoses: 692, lat: 37.2932, lon: -80.0547, address: "1970 Roanoke Blvd, Salem, VA 24153" },
            { name: "Salisbury, NC HCS", code: "659", region: "V06", diagnoses: 889, lat: 35.6709, lon: -80.4742, address: "1601 Brenner Ave, Salisbury, NC 28144" },
            { name: "Atlanta, GA HCS", code: "508", region: "V07", diagnoses: 1063, lat: 33.7490, lon: -84.3880, address: "1670 Clairmont Rd, Decatur, GA 30033" },
            { name: "Augusta, GA HCS", code: "509", region: "V07", diagnoses: 432, lat: 33.4735, lon: -82.0105, address: "950 15th St, Augusta, GA 30901" },
            { name: "Birmingham, AL HCS", code: "521", region: "V07", diagnoses: 777, lat: 33.5186, lon: -86.8104, address: "700 S 19th St, Birmingham, AL 35233" },
            { name: "Charleston, SC HCS", code: "534", region: "V07", diagnoses: 769, lat: 32.7765, lon: -79.9311, address: "109 Bee St, Charleston, SC 29401" },
            { name: "Columbia, SC HCS", code: "544", region: "V07", diagnoses: 839, lat: 34.0007, lon: -81.0348, address: "6439 Garners Ferry Rd, Columbia, SC 29209" },
            { name: "Dublin, GA HCS", code: "557", region: "V07", diagnoses: 333, lat: 32.5404, lon: -82.9038, address: "1826 Veterans Blvd, Dublin, GA 31021" },
            { name: "Central Alabama HCS", code: "619", region: "V07", diagnoses: 401, lat: 32.3668, lon: -86.2999, address: "215 Perry Hill Rd, Montgomery, AL 36109" },
            { name: "Tuscaloosa, AL HCS", code: "679", region: "V07", diagnoses: 251, lat: 33.2098, lon: -87.5692, address: "3701 Loop Rd E, Tuscaloosa, AL 35404" },
            { name: "Bay Pines, FL HCS", code: "516", region: "V08", diagnoses: 992, lat: 27.8128, lon: -82.7774, address: "10000 Bay Pines Blvd, Bay Pines, FL 33744" },
            { name: "Miami, FL HCS", code: "546", region: "V08", diagnoses: 336, lat: 25.7617, lon: -80.1918, address: "1201 NW 16th St, Miami, FL 33125" },
            { name: "West Palm Beach, FL HCS", code: "548", region: "V08", diagnoses: 708, lat: 26.7153, lon: -80.0534, address: "7305 N Military Trl, West Palm Beach, FL 33410" },
            { name: "Gainesville, FL HCS", code: "573", region: "V08", diagnoses: 2268, lat: 29.6516, lon: -82.3248, address: "1601 SW Archer Rd, Gainesville, FL 32608" },
            { name: "San Juan, PR HCS", code: "672", region: "V08", diagnoses: 312, lat: 18.4655, lon: -66.1057, address: "10 Casia St, San Juan, PR 00921" },
            { name: "Tampa, FL HCS", code: "673", region: "V08", diagnoses: 975, lat: 27.9506, lon: -82.4572, address: "13000 Bruce B Downs Blvd, Tampa, FL 33612" },
            { name: "Orlando, FL HCS", code: "675", region: "V08", diagnoses: 1137, lat: 28.5383, lon: -81.3792, address: "13800 Veterans Way, Orlando, FL 32827" },
            { name: "Lexington, KY HCS", code: "596", region: "V09", diagnoses: 802, lat: 38.0406, lon: -84.5037, address: "1101 Veterans Dr, Lexington, KY 40502" },
            { name: "Louisville, KY HCS", code: "603", region: "V09", diagnoses: 863, lat: 38.2527, lon: -85.7585, address: "800 Zorn Ave, Louisville, KY 40206" },
            { name: "Memphis, TN HCS", code: "614", region: "V09", diagnoses: 510, lat: 35.1495, lon: -90.0490, address: "1030 Jefferson Ave, Memphis, TN 38104" },
            { name: "Mountain Home, TN HCS", code: "621", region: "V09", diagnoses: 1401, lat: 36.3334, lon: -82.3543, address: "Corner of Lamont & Veterans Way, Mountain Home, TN 37684" },
            { name: "Middle Tennessee HCS", code: "626", region: "V09", diagnoses: 1563, lat: 36.1627, lon: -86.7816, address: "1310 24th Ave S, Nashville, TN 37212" },
            { name: "Ann Arbor, MI HCS", code: "506", region: "V10", diagnoses: 762, lat: 42.2808, lon: -83.7430, address: "2215 Fuller Rd, Ann Arbor, MI 48105" },
            { name: "Battle Creek, MI HCS", code: "515", region: "V10", diagnoses: 579, lat: 42.3211, lon: -85.1797, address: "5500 Armstrong Rd, Battle Creek, MI 49037" },
            { name: "Chillicothe, OH HCS", code: "538", region: "V10", diagnoses: 321, lat: 39.3331, lon: -82.9824, address: "17273 State Route 104, Chillicothe, OH 45601" },
            { name: "Cincinnati, OH HCS", code: "539", region: "V10", diagnoses: 742, lat: 39.1031, lon: -84.5120, address: "3200 Vine St, Cincinnati, OH 45220" },
            { name: "Cleveland, OH HCS", code: "541", region: "V10", diagnoses: 1670, lat: 41.4993, lon: -81.6944, address: "10701 East Blvd, Cleveland, OH 44106" },
            { name: "Dayton, OH HCS", code: "552", region: "V10", diagnoses: 624, lat: 39.7589, lon: -84.1916, address: "4100 W 3rd St, Dayton, OH 45428" },
            { name: "Detroit, MI HCS", code: "553", region: "V10", diagnoses: 328, lat: 42.3314, lon: -83.0458, address: "4646 John R St, Detroit, MI 48201" },
            { name: "Indianapolis, IN HCS", code: "583", region: "V10", diagnoses: 1060, lat: 39.7684, lon: -86.1581, address: "1481 W 10th St, Indianapolis, IN 46202" },
            { name: "Northern Indiana HCS", code: "610", region: "V10", diagnoses: 717, lat: 41.6834, lon: -86.2500, address: "1700 E 38th St, Marion, IN 46953" },
            { name: "Saginaw, MI HCS", code: "655", region: "V10", diagnoses: 626, lat: 43.4195, lon: -83.9508, address: "1500 Weiss St, Saginaw, MI 48602" },
            { name: "Columbus, OH HCS", code: "757", region: "V10", diagnoses: "<100", lat: 39.9612, lon: -82.9988, address: "420 N James Rd, Columbus, OH 43219" },
            { name: "Chicago, IL HCS", code: "537", region: "V12", diagnoses: 207, lat: 41.8781, lon: -87.6298, address: "333 E Huron St, Chicago, IL 60611" },
            { name: "Danville, IL HCS", code: "550", region: "V12", diagnoses: 424, lat: 40.1244, lon: -87.6300, address: "1900 E Main St, Danville, IL 61832" },
            { name: "North Chicago, IL HCS", code: "556", region: "V12", diagnoses: 376, lat: 42.3256, lon: -87.8412, address: "3001 Green Bay Rd, North Chicago, IL 60064" },
            { name: "Hines, IL HCS", code: "578", region: "V12", diagnoses: 498, lat: 41.8561, lon: -87.8367, address: "5000 S 5th Ave, Hines, IL 60141" },
            { name: "Iron Mountain, MI HCS", code: "585", region: "V12", diagnoses: 272, lat: 45.8202, lon: -88.0654, address: "325 E H St, Iron Mountain, MI 49801" },
            { name: "Madison, WI HCS", code: "607", region: "V12", diagnoses: 637, lat: 43.0731, lon: -89.4012, address: "2500 Overlook Ter, Madison, WI 53705" },
            { name: "Tomah, WI HCS", code: "676", region: "V12", diagnoses: 434, lat: 43.9786, lon: -90.5043, address: "500 E Veterans St, Tomah, WI 54660" },
            { name: "Milwaukee, WI HCS", code: "695", region: "V12", diagnoses: 743, lat: 43.0389, lon: -87.9065, address: "5000 W National Ave, Milwaukee, WI 53295" },
            { name: "Kansas City, MO HCS", code: "589", region: "V15", diagnoses: 811, lat: 39.0997, lon: -94.5786, address: "4801 Linwood Blvd, Kansas City, MO 64128" },
            { name: "Columbia, MO HCS", code: "589A4", region: "V15", diagnoses: 671, lat: 38.9517, lon: -92.3341, address: "800 Hospital Dr, Columbia, MO 65201" },
            { name: "Eastern Kansas HCS", code: "589A5", region: "V15", diagnoses: 549, lat: 39.0473, lon: -95.6752, address: "2200 SW Gage Blvd, Topeka, KS 66622" },
            { name: "Wichita, KS HCS", code: "589A7", region: "V15", diagnoses: 512, lat: 37.6872, lon: -97.3301, address: "5500 E Kellogg Dr, Wichita, KS 67218" },
            { name: "St. Louis, MO HCS", code: "657", region: "V15", diagnoses: 804, lat: 38.6270, lon: -90.1994, address: "915 N Grand Blvd, St. Louis, MO 63106" },
            { name: "Poplar Bluff, MO HCS", code: "657A4", region: "V15", diagnoses: 452, lat: 36.7570, lon: -90.3929, address: "1500 N Westwood Blvd, Poplar Bluff, MO 63901" },
            { name: "Marion, IL HCS", code: "657A5", region: "V15", diagnoses: 673, lat: 37.7306, lon: -88.9331, address: "2401 W Main St, Marion, IL 62959" },
            { name: "Alexandria, LA HCS", code: "502", region: "V16", diagnoses: 303, lat: 31.3113, lon: -92.4451, address: "2495 Shreveport Hwy, Pineville, LA 71360" },
            { name: "Gulf Coast, MS HCS", code: "520", region: "V16", diagnoses: 913, lat: 30.3960, lon: -89.0928, address: "400 Veterans Ave, Biloxi, MS 39531" },
            { name: "Fayetteville, AR HCS", code: "564", region: "V16", diagnoses: 1060, lat: 36.0626, lon: -94.1574, address: "1100 N College Ave, Fayetteville, AR 72703" },
            { name: "Houston, TX HCS", code: "580", region: "V16", diagnoses: 1011, lat: 29.7604, lon: -95.3698, address: "2002 Holcombe Blvd, Houston, TX 77030" },
            { name: "Jackson, MS HCS", code: "586", region: "V16", diagnoses: 326, lat: 32.2988, lon: -90.1848, address: "1500 E Woodrow Wilson Ave, Jackson, MS 39216" },
            { name: "New Orleans, LA HCS", code: "629", region: "V16", diagnoses: 355, lat: 29.9511, lon: -90.0715, address: "2400 Canal St, New Orleans, LA 70119" },
            { name: "Shreveport, LA HCS", code: "667", region: "V16", diagnoses: 648, lat: 32.5252, lon: -93.7502, address: "510 E Stoner Ave, Shreveport, LA 71101" },
            { name: "Amarillo, TX HCS", code: "504", region: "V17", diagnoses: 296, lat: 35.2220, lon: -101.8313, address: "6010 W Amarillo Blvd, Amarillo, TX 79106" },
            { name: "Big Spring, TX HCS", code: "519", region: "V17", diagnoses: 269, lat: 32.2504, lon: -101.4787, address: "300 Veterans Blvd, Big Spring, TX 79720" },
            { name: "Dallas, TX HCS", code: "549", region: "V17", diagnoses: 1075, lat: 32.7767, lon: -96.7970, address: "4500 S Lancaster Rd, Dallas, TX 75216" },
            { name: "San Antonio, TX HCS", code: "671", region: "V17", diagnoses: 1321, lat: 29.4241, lon: -98.4936, address: "7400 Merton Minter, San Antonio, TX 78229" },
            { name: "Temple, TX HCS", code: "674", region: "V17", diagnoses: 1239, lat: 31.0982, lon: -97.3428, address: "1901 Veterans Memorial Dr, Temple, TX 76504" },
            { name: "Texas Valley Coastal Bend HCS", code: "740", region: "V17", diagnoses: 323, lat: 27.8006, lon: -97.3964, address: "2601 Veterans Memorial Dr, Harlingen, TX 78550" },
            { name: "El Paso, TX HCS", code: "756", region: "V17", diagnoses: 287, lat: 31.7619, lon: -106.4850, address: "5001 N Piedras St, El Paso, TX 79930" },
            { name: "Montana HCS", code: "436", region: "V19", diagnoses: 661, lat: 46.5891, lon: -112.0391, address: "3687 Veterans Dr, Fort Harrison, MT 59636" },
            { name: "Cheyenne, WY HCS", code: "442", region: "V19", diagnoses: 308, lat: 41.1400, lon: -104.8202, address: "2360 E Pershing Blvd, Cheyenne, WY 82001" },
            { name: "Aurora, CO HCS", code: "554", region: "V19", diagnoses: 972, lat: 39.7294, lon: -104.8319, address: "1700 N Wheeling St, Aurora, CO 80045" },
            { name: "Grand Junction, CO HCS", code: "575", region: "V19", diagnoses: 230, lat: 39.0639, lon: -108.5506, address: "2121 North Ave, Grand Junction, CO 81501" },
            { name: "Muskogee, OK HCS", code: "623", region: "V19", diagnoses: 747, lat: 35.7479, lon: -95.3697, address: "1011 Honor Heights Dr, Muskogee, OK 74401" },
            { name: "Oklahoma City, OK HCS", code: "635", region: "V19", diagnoses: 1365, lat: 35.4676, lon: -97.5164, address: "921 NE 13th St, Oklahoma City, OK 73104" },
            { name: "Salt Lake City, UT HCS", code: "660", region: "V19", diagnoses: 993, lat: 40.7608, lon: -111.8910, address: "500 Foothill Dr, Salt Lake City, UT 84148" },
            { name: "Sheridan, WY HCS", code: "666", region: "V19", diagnoses: 207, lat: 44.7966, lon: -106.9562, address: "1898 Fort Rd, Sheridan, WY 82801" },
            { name: "Anchorage, AK HCS", code: "463", region: "V20", diagnoses: 341, lat: 61.2181, lon: -149.9003, address: "1201 N Muldoon Rd, Anchorage, AK 99504" },
            { name: "Boise, ID HCS", code: "531", region: "V20", diagnoses: 725, lat: 43.6150, lon: -116.2023, address: "500 W Fort St, Boise, ID 83702" },
            { name: "Portland, OR HCS", code: "648", region: "V20", diagnoses: 1283, lat: 45.5152, lon: -122.6784, address: "3710 SW US Veterans Hospital Rd, Portland, OR 97239" },
            { name: "Roseburg, OR HCS", code: "653", region: "V20", diagnoses: 321, lat: 43.2165, lon: -123.3417, address: "913 NW Garden Valley Blvd, Roseburg, OR 97471" },
            { name: "Puget Sound, WA HCS", code: "663", region: "V20", diagnoses: 1163, lat: 47.6062, lon: -122.3321, address: "1660 S Columbian Way, Seattle, WA 98108" },
            { name: "Spokane, WA HCS", code: "668", region: "V20", diagnoses: 580, lat: 47.6588, lon: -117.4260, address: "4815 N Assembly St, Spokane, WA 99205" },
            { name: "Walla Walla, WA HCS", code: "687", region: "V20", diagnoses: 313, lat: 46.0646, lon: -118.3430, address: "77 Wainwright Dr, Walla Walla, WA 99362" },
            { name: "White City, OR HCS", code: "692", region: "V20", diagnoses: 230, lat: 42.4393, lon: -122.8442, address: "8495 Crater Lake Hwy, White City, OR 97503" },
            { name: "Manila, PI HCS", code: "358", region: "V21", diagnoses: "<100", lat: 14.5995, lon: 120.9842, address: "1501 Roxas Blvd, Pasay, Metro Manila, Philippines" },
            { name: "Honolulu, HI HCS", code: "459", region: "V21", diagnoses: 212, lat: 21.3099, lon: -157.8581, address: "459 Patterson Rd, Honolulu, HI 96819" },
            { name: "Fresno, CA HCS", code: "570", region: "V21", diagnoses: 295, lat: 36.7378, lon: -119.7871, address: "2615 E Clinton Ave, Fresno, CA 93703" },
            { name: "Las Vegas, NV HCS", code: "593", region: "V21", diagnoses: 565, lat: 36.1699, lon: -115.1398, address: "6900 N Pecos Rd, North Las Vegas, NV 89086" },
            { name: "N. California HCS", code: "612A4", region: "V21", diagnoses: 893, lat: 38.5816, lon: -121.4944, address: "10535 Hospital Way, Mather, CA 95655" },
            { name: "Palo Alto, CA HCS", code: "640", region: "V21", diagnoses: 315, lat: 37.4419, lon: -122.1430, address: "3801 Miranda Ave, Palo Alto, CA 94304" },
            { name: "Reno, NV HCS", code: "654", region: "V21", diagnoses: 373, lat: 39.5296, lon: -119.8138, address: "1000 Locust St, Reno, NV 89502" },
            { name: "San Francisco, CA HCS", code: "662", region: "V21", diagnoses: 587, lat: 37.7749, lon: -122.4194, address: "4150 Clement St, San Francisco, CA 94121" },
            { name: "New Mexico HCS", code: "501", region: "V22", diagnoses: 698, lat: 35.0844, lon: -106.6504, address: "1501 San Pedro Dr SE, Albuquerque, NM 87108" },
            { name: "Long Beach, CA HCS", code: "600", region: "V22", diagnoses: 225, lat: 33.7701, lon: -118.1937, address: "5901 E 7th St, Long Beach, CA 90822" },
            { name: "Loma Linda, CA HCS", code: "605", region: "V22", diagnoses: 419, lat: 34.0484, lon: -117.2612, address: "11201 Benton St, Loma Linda, CA 92357" },
            { name: "Phoenix, AZ HCS", code: "644", region: "V22", diagnoses: 908, lat: 33.4484, lon: -112.0740, address: "650 E Indian School Rd, Phoenix, AZ 85012" },
            { name: "Northern Arizona HCS", code: "649", region: "V22", diagnoses: 376, lat: 35.1983, lon: -111.6513, address: "500 N Hwy 89, Prescott, AZ 86313" },
            { name: "San Diego, CA HCS", code: "664", region: "V22", diagnoses: 549, lat: 32.7157, lon: -117.1611, address: "3350 La Jolla Village Dr, San Diego, CA 92161" },
            { name: "Southern Arizona HCS", code: "678", region: "V22", diagnoses: 931, lat: 32.2226, lon: -110.9747, address: "3601 S 6th Ave, Tucson, AZ 85723" },
            { name: "Greater Los Angeles, CA HCS", code: "691", region: "V22", diagnoses: 682, lat: 34.0522, lon: -118.2437, address: "11301 Wilshire Blvd, Los Angeles, CA 90073" },
            { name: "Fargo, ND HCS", code: "437", region: "V23", diagnoses: 592, lat: 46.8772, lon: -96.7898, address: "2101 N Elm St, Fargo, ND 58102" },
            { name: "Sioux Falls, SD HCS", code: "438", region: "V23", diagnoses: 519, lat: 43.5460, lon: -96.7313, address: "2501 W 22nd St, Sioux Falls, SD 57105" },
            { name: "Black Hills, SD HCS", code: "568", region: "V23", diagnoses: 324, lat: 44.0805, lon: -103.2310, address: "500 N 5th St, Hot Springs, SD 57747" },
            { name: "Minneapolis, MN HCS", code: "618", region: "V23", diagnoses: 1549, lat: 44.9778, lon: -93.2650, address: "1 Veterans Dr, Minneapolis, MN 55417" },
            { name: "Nebraska-W Iowa HCS", code: "636", region: "V23", diagnoses: 781, lat: 41.2565, lon: -95.9345, address: "4101 Woolworth Ave, Omaha, NE 68105" },
            { name: "Central Iowa HCS", code: "636A6", region: "V23", diagnoses: 625, lat: 41.5868, lon: -93.6250, address: "3600 30th St, Des Moines, IA 50310" },
            { name: "Iowa City, IA HCS", code: "636A8", region: "V23", diagnoses: 814, lat: 41.6611, lon: -91.5302, address: "601 Highway 6 W, Iowa City, IA 52246" },
            { name: "St. Cloud, MN HCS", code: "656", region: "V23", diagnoses: 517, lat: 45.5608, lon: -94.1632, address: "4801 Veterans Dr, St. Cloud, MN 56303" }
        ];

        // Calculate distance between two coordinates using Haversine formula
        function calculateDistance(lat1, lon1, lat2, lon2) {
            const R = 3959; // Earth's radius in miles
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLon = (lon2 - lon1) * Math.PI / 180;
            const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                     Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                     Math.sin(dLon/2) * Math.sin(dLon/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            return R * c;
        }

// Get coordinates from city and state
async function getCoordinatesFromCityState(city, state) {
    // Clean up city name
    city = city.trim();
    
    if (!city || !state) {
        throw new Error('Please enter both city and state.');
    }

    // Try OpenStreetMap Nominatim first (more reliable)
    try {
        const response = await fetch(`https://nominatim.openstreetmap.org/search?city=${encodeURIComponent(city)}&state=${state}&country=USA&format=json&limit=1`, {
            headers: {
                'User-Agent': 'VA-RLS-Finder/1.0'
            }
        });
        if (response.ok) {
            const data = await response.json();
            if (data && data.length > 0) {
                return {
                    lat: parseFloat(data[0].lat),
                    lon: parseFloat(data[0].lon),
                    city: city,
                    state: state
                };
            }
        }
    } catch (error) {
        console.log('Nominatim failed, trying next...');
    }

    // Try with full query string
    try {
        const query = `${city}, ${state}, USA`;
        const response = await fetch(`https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(query)}&format=json&limit=1`, {
            headers: {
                'User-Agent': 'VA-RLS-Finder/1.0'
            }
        });
        if (response.ok) {
            const data = await response.json();
            if (data && data.length > 0) {
                return {
                    lat: parseFloat(data[0].lat),
                    lon: parseFloat(data[0].lon),
                    city: city,
                    state: state
                };
            }
        }
    } catch (error) {
        console.log('Full query search failed, trying geocode.xyz...');
    }

    // Try geocode.xyz as third option
    try {
        // Add a small delay to avoid rate limiting
        await new Promise(resolve => setTimeout(resolve, 500));
        const response = await fetch(`https://geocode.xyz/${encodeURIComponent(city)},${state},USA?json=1`);
        if (response.ok) {
            const data = await response.json();
            if (data.latt && data.longt && !data.error) {
                return {
                    lat: parseFloat(data.latt),
                    lon: parseFloat(data.longt),
                    city: city,
                    state: state
                };
            }
        }
    } catch (error) {
        console.log('Geocode.xyz failed');
    }

    throw new Error(`Unable to find coordinates for ${city}, ${state}. Please try a nearby city or verify the spelling.`);
}
        // Create provider search URL
        function createProviderSearchURL(facilityName, city, state) {
            const baseURL = 'https://www.va.gov/find-locations/';
            // Clean up facility name for search
            const searchTerm = facilityName.replace(/ HCS$/, '').replace(/,/g, '');
            return `${baseURL}?facilityType=health&page=1&query=${encodeURIComponent(searchTerm)}`;
        }

async function searchLocations() {
    const cityInput = document.getElementById('city');
    const stateSelect = document.getElementById('state');
    const searchBtn = document.getElementById('searchBtn');
    const resultsDiv = document.getElementById('results');
    const loadingDiv = document.getElementById('loading');
    const errorDiv = document.getElementById('error');
    
    const city = cityInput.value.trim();
    const state = stateSelect.value;
    
    // Validate inputs
    if (!city) {
        showError('Please enter a city name.');
        return;
    }
    
    if (!state) {
        showError('Please select a state.');
        return;
    }

    // Prevent double-clicks
    if (searchBtn.disabled) {
        return;
    }

    // Clear everything immediately and show loading
    resultsDiv.innerHTML = '';
    resultsDiv.style.display = 'none';
    errorDiv.style.display = 'none';
    loadingDiv.style.display = 'block';
    searchBtn.disabled = true;

    try {
        // Get coordinates for city and state
        const userLocation = await getCoordinatesFromCityState(city, state);

        // Calculate distances and sort
        const locationsWithDistance = vaData.map(location => ({
            ...location,
            distance: calculateDistance(
                userLocation.lat,
                userLocation.lon,
                location.lat,
                location.lon
            )
        })).sort((a, b) => a.distance - b.distance);

        // Get top 5 closest locations
        const closestLocations = locationsWithDistance.slice(0, 5);

        // Clear again right before displaying new results
        resultsDiv.innerHTML = '';
        
        // Display results
        displayResults(closestLocations, userLocation);
        resultsDiv.style.display = 'block';

    } catch (error) {
        showError(error.message);
    } finally {
        loadingDiv.style.display = 'none';
        searchBtn.disabled = false;
    }
}

        function displayResults(locations, userLocation) {
            const resultsDiv = document.getElementById('results');
            
            if (locations.length === 0) {
                resultsDiv.innerHTML = '<div class="no-results">No VA locations found.</div>';
                return;
            }

            let html = `<h2 style="color: #2c3e50; margin-bottom: 20px;">üìç Closest VA Locations to ${userLocation.city}, ${userLocation.state}</h2>`;

            locations.forEach((location, index) => {
                const providerSearchURL = 'https://www.va.gov/find-locations/';
                
                html += `
                    <div class="location-card">
                        <div class="location-header">
                            <div class="location-name">${index + 1}. ${location.name}</div>
                            <div class="diagnosis-badge">${location.diagnoses} RLS Cases</div>
                        </div>
                        <div class="distance">üìè ${location.distance.toFixed(1)} miles away</div>
                        <div class="info-grid">
                            <span class="info-label">Address:</span>
                            <span class="info-value">${location.address}</span>
                            <span class="info-label">Facility Code:</span>
                            <span class="info-value">${location.code}</span>
                            <span class="info-label">Region:</span>
                            <span class="info-value">${location.region}</span>
                            <span class="info-label">Coordinates:</span>
                            <span class="info-value">${location.lat.toFixed(4)}¬∞N, ${Math.abs(location.lon).toFixed(4)}¬∞W</span>
                        </div>
                        <div class="provider-search">
                            <strong>ü©∫ Find VA Doctors:</strong>
                            <a href="${providerSearchURL}" target="_blank" class="provider-link">
                                Search VA Provider Directory ‚Üí
                            </a>
                        </div>
                    </div>
                `;
            });

            resultsDiv.innerHTML = html;
        }

        function showError(message) {
            const errorDiv = document.getElementById('error');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
        }

        // Allow Enter key to trigger search from city input
        document.getElementById('city').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchLocations();
            }
        });
    </script>
</body>
</html>
